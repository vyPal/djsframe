<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>dispatcher.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="FrameClient.html">FrameClient</a><ul class='methods'><li data-type='method'><a href="FrameClient.html#setDispatcher">setDispatcher</a></li><li data-type='method'><a href="FrameClient.html#setRegistry">setRegistry</a></li></ul></li><li></li><li><a href="FrameCommand.html">FrameCommand</a><ul class='methods'><li data-type='method'><a href="FrameCommand.html#run">run</a></li><li data-type='method'><a href="FrameCommand.html#validateInfo">validateInfo</a></li></ul></li><li></li><li><a href="FrameDispatcher.html">FrameDispatcher</a><ul class='methods'><li data-type='method'><a href="FrameDispatcher.html#handleCommand">handleCommand</a></li><li data-type='method'><a href="FrameDispatcher.html#handleMessage">handleMessage</a></li><li data-type='method'><a href="FrameDispatcher.html#handleSlash">handleSlash</a></li></ul></li><li></li><li><a href="FrameGroup.html">FrameGroup</a></li><li></li><li><a href="FrameRegistry.html">FrameRegistry</a><ul class='methods'><li data-type='method'><a href="FrameRegistry.html#registerCommand">registerCommand</a></li><li data-type='method'><a href="FrameRegistry.html#registerCommands">registerCommands</a></li><li data-type='method'><a href="FrameRegistry.html#registerCommandsInDir">registerCommandsInDir</a></li><li data-type='method'><a href="FrameRegistry.html#registerDefaultCommands">registerDefaultCommands</a></li><li data-type='method'><a href="FrameRegistry.html#registerDefaultGroups">registerDefaultGroups</a></li><li data-type='method'><a href="FrameRegistry.html#registerDefaults">registerDefaults</a></li><li data-type='method'><a href="FrameRegistry.html#registerGroup">registerGroup</a></li><li data-type='method'><a href="FrameRegistry.html#registerGroups">registerGroups</a></li><li data-type='method'><a href="FrameRegistry.html#setCommandDir">setCommandDir</a></li></ul></li><li></li><li><a href="SQLiteProvider.html">SQLiteProvider</a><ul class='methods'><li data-type='method'><a href="SQLiteProvider.html#.getGuildID">getGuildID</a></li><li data-type='method'><a href="SQLiteProvider.html#clear">clear</a></li><li data-type='method'><a href="SQLiteProvider.html#destroy">destroy</a></li><li data-type='method'><a href="SQLiteProvider.html#get">get</a></li><li data-type='method'><a href="SQLiteProvider.html#init">init</a></li><li data-type='method'><a href="SQLiteProvider.html#remove">remove</a></li><li data-type='method'><a href="SQLiteProvider.html#set">set</a></li><li data-type='method'><a href="SQLiteProvider.html#updateOtherShards">updateOtherShards</a></li></ul></li></ul><h3>Externals</h3><ul><li><a href="external-SQLiteDatabase.html">SQLiteDatabase</a></li><li><a href="external-SQLiteStatement.html">SQLiteStatement</a></li></ul><h3>Events</h3><ul><li><a href="FrameClient.html#event:commandRegister">commandRegister</a></li><li><a href="FrameClient.html#event:groupRegister">groupRegister</a></li><li><a href="FrameClient.html#event:setCommandDir">setCommandDir</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<div id="main">
    
    <h1 class="page-title">dispatcher.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Class for handling and running commands
 * @class FrameDispatcher
 */
class FrameDispatcher {
  /**
   * Creates a dispatcher
   * @constructor
   * @param {FrameClient} client - The client for which the dispatcher is being created
   * @param {FrameRegistry} registry - The registry in which groups and commands are registered
   */
  constructor(client, registry) {
    Object.defineProperty(this, 'client', { value: client });
    this.registry = registry || this.client.registry;
  }

  /**
   * Handles a incoming message
   * @param {Message} message - The message to handle
   * @return {boolean} - False if not executed and true if executed
   */
  handleMessage(message) {
    if(message.author.bot) return false;
    if(this.client.provider.get('global', 'user-blacklist', []).some(id => message.author.id === id)) return false;
    let prefix = this.client.provider.get(message.guild.id, 'prefix', this.client.options.prefix);
    if(message.content.startswith(prefix)) {
      return this.handleCommand(message, 1, prefix);
    }
    if(message.metnions.has(this.client.user.id)) {
      return this.handleCommand(message, 2);
    }
  }

  /**
   * Handles a slash command
   * @param {Interaction} interaction - The interaction to handle
   */
  handleSlash(interaction) {
    if(interaction.isCommand()) {
      this.handleCommand(interaction, 3);
    }
  }

  /**
   * Handles a command
   * @param {Message|Interaction} message - The message (or interaction) containing the command
   * @param {Integer} starttype - The type of the command start (1-prefix, 2-mention, 3-interaction)
   * @param {String} [prefix=null] - The prefix used if starttype == 1
   */
  handleCommand(message, starttype, prefix = null){
    if(starttype === 1) {
      let args = message.content.split(' ');
      let commandName = args[0].slice(prefix.length);
      args = args.slice(1);
      let command = this.client.registry.commands.get(commandName.toLowerCase());
      command.run(message, args);
    }
  }
}

export default FrameDispatcher;</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.7</a> on Fri Sep 17 2021 15:31:56 GMT+0200 (Středoevropský letní čas) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
